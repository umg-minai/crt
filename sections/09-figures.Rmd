# Figures

## Flowchart

```{r consort-flowchart, echo = FALSE, fig.width = 12, fig.cap = "The flowchart depicts the inclusion and exclusion criteria. CVC, central venous catheter; FV, femoral vene; SCV, subclavian vene."}
library("consort")

.txt <- function(label, n)paste0(label, "\n (n = ", n, ")")
narms <- table(cvc$ManLu[!cvc$isExcluded])
narms <- narms[narms > 0]
arms <- paste0(
    substring(names(narms), 1, 5), ", ",
    substring(names(narms), 6, 6), " Lumens"
)
excl <- table(cvc$ExclusionReason)
eord <- c(
    grep("Site", names(excl)),
    grep("Lumen", names(excl))
)
eord <- c(seq_len(length(excl))[eord], seq_len(length(excl))[-eord])
excl <- excl[eord]
excl <- paste0(
    "Excluded (n = ", sum(excl), ")",
    paste0("\n\u2022 ", names(excl), " (n = ", excl, ")", collapse = "")
)

cnsrt <-
    add_box(txt = .txt("Screened CVCs", nrow(cvc))) |>
    add_side_box(txt = excl) |>
    add_box(txt = .txt("Eligible CVCs", sum(!cvc$isExcluded))) |>
    add_split(txt = .txt(arms, narms)) |>
    add_label_box(txt = c(
        "1" = "Enrollment",
        "2" = "Allocation",
        "3" = "Analysis")
    )
plot(cnsrt)
```

## Survival plots

```{r survplotml3, echo = FALSE, fig.width = 12, fig.height = 8, fig.cap = "Survival plot showing CRT-free time for 3 lumen CVCs by Arrow and Braun."}
nms <- c("Arrow", "Braun")
ggsurvplot(
    ml3$svf,
    data = ml3$data,
    palette = unname(mcol[nms]),
    pval = TRUE,
    censor = TRUE,
    censor.shape = 124,
    conf.int = TRUE,
    conf.int.style = "ribbon",
    xlim = c(0, 14),
    pval.coord = c(12, 0.8),
    break.time.by = 2,
    risk.table = TRUE,
    ggtheme = theme_minimal(),
    risk.table.y.text.col = TRUE,
    risk.table.y.text = TRUE,
    surv.median.line = "v"
)
```

```{r survplotml5, echo = FALSE, fig.width = 12, fig.height = 8, fig.cap = "Survival plot showing CRT-free time for 5 lumen CVCs by Arrow and Vygon."}
nms <- c("Arrow", "Vygon")
ggsurvplot(
    ml5$svf,
    data = ml5$data,
    palette = unname(mcol[nms]),
    pval = TRUE,
    pval.coord = c(12, 0.8),
    censor = TRUE,
    censor.shape = 124,
    conf.int = TRUE,
    conf.int.style = "ribbon",
    xlim = c(0, 14),
    break.time.by = 2,
    risk.table = TRUE,
    ggtheme = theme_minimal(),
    risk.table.y.text.col = TRUE,
    risk.table.y.text = TRUE,
    surv.median.line = "v"
)
```

## Regression

```{r forestplot, echo = FALSE, fig.width = 12, fig.height = 8, fig.cap = "Hazard ratios"}
ml <- cvc[!cvc$isExcluded,]
ml$CRT <- ml$CRT == "CRT"
ml$FUP <- .followup(ml)
ml$Side <- relevel(ml$Side, ref = "right")
ml$PerioperativePlacement <- factor(ml$PerioperativePlacement, levels = c("no", "yes"))
ml$Lumens <- factor(ml$Lumens)
ml$Experience <- factor(ml$Experience, levels = c("<25", "25-50", ">50"), ordered = FALSE)
ml$Attempts2 <- droplevels(factor(ml$Attempts2, levels = c("1", ">1", "NA")))
ml$Incision <- droplevels(factor(ml$Incision, levels = c("no", "yes", "NA")))
ml$Sepsis <- factor(ml$Sepsis, levels = c(0, 1), labels = c("no", "yes"))
ml$Cancer <- factor(ml$Cancer, levels = c(0, 1), labels = c("no", "yes"))
ml$AdmissionType <- relevel(ml$AdmissionType, ref = "surgical")
ml$AnticoagulationGroup <- droplevels(ml$AnticoagulationGroup)
ml$AnticoagulationGroup <- relevel(ml$AnticoagulationGroup, ref = "LMWH")
ml$WBC1 <- log(ml$WBC1)
ml$CRP1 <- log(ml$CRP1)
ml$DDimer1 <- log(ml$DDimer1)
ml$DDimer1[is.infinite(ml$DDimer1)] <- NA

rgcx <- coxph(
    Surv(FUP, CRT) ~
        Sex + Age + BMI + Manufacturer + Lumens +
        Side + PerioperativePlacement + PerioperativePlacement +
        Sepsis + Cancer + DVT + AnticoagulationGroup,
    data = ml
)
rgcx

ggforest(rgcx, data = ml)
```

```{r forestplot2, echo = FALSE, fig.width = 12, fig.height = 8}
rgcxlab <- coxph(
    Surv(FUP, CRT) ~
        Sex + Age + BMI + Manufacturer + Lumens +
        Side + Attempts2 + Incision + Experience + PerioperativePlacement +
        AdmissionType + Sepsis + Cancer + DVT + AnticoagulationGroup +
        WBC1 + CRP1 + DDimer1,
    data = ml
)
rgcxlab
ggforest(rgcxlab, data = ml)
```

## EM images

### Arrow 3L vs Braun 3L

:::columns

:::column
![](images/electron-microscopic-images/SEN1_1-1_A3L_100x.png)
![](images/electron-microscopic-images/SEN1_1-3_A3L_1000x.png)
:::

:::column
![](images/electron-microscopic-images/SEN1_5-1_B3L_100x.png)
![](images/electron-microscopic-images/SEN1_5-2_B3L_1000x.png)
:::

:::

### Arrow 5L vs Vygon 5L

:::columns

:::column
![](images/electron-microscopic-images/SEN1_3-1_A5L_100x.png)
![](images/electron-microscopic-images/SEN1_3-2_A5L_1000x.png)
:::

:::column
![](images/electron-microscopic-images/SEN1_4-1_V5L_100x.png)
![](images/electron-microscopic-images/SEN1_4-2_V5L_1000x.png)
:::

:::
